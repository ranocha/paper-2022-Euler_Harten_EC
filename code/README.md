
# Verification of equations

The Mathematica notebook `verification.nb` and its printed form
`verification.pdf` contain verifications of various calculations
presented in the manuscript.


# Reproducibility of numerical experiments

The implementation of the entropy-conservative numerical flux of
Sjögreen and Yee (2019) can be verified as follows. First, a convergence
test using a manufactured solution can be conducted by executing the following
commands in the Julia REPL.
```julia
julia> include("setup.jl")

julia> convergence_test("elixir_euler_convergence_test.jl", 3)
```
This produces an output similar to
```
[...]
####################################################################################################
l2
rho                 rho_v1              rho_v2              rho_e
error     EOC       error     EOC       error     EOC       error     EOC
9.32e-07  -         1.42e-06  -         1.42e-06  -         4.82e-06  -
7.03e-08  3.73      9.53e-08  3.90      9.53e-08  3.90      3.30e-07  3.87
4.65e-09  3.92      6.09e-09  3.97      6.09e-09  3.97      2.12e-08  3.96

mean      3.82      mean      3.93      mean      3.93      mean      3.91
----------------------------------------------------------------------------------------------------
linf
rho                 rho_v1              rho_v2              rho_e
error     EOC       error     EOC       error     EOC       error     EOC
9.58e-06  -         1.17e-05  -         1.17e-05  -         4.89e-05  -
6.23e-07  3.94      7.48e-07  3.97      7.48e-07  3.97      3.22e-06  3.92
4.05e-08  3.94      4.97e-08  3.91      4.97e-08  3.91      2.10e-07  3.94

mean      3.94      mean      3.94      mean      3.94      mean      3.93
----------------------------------------------------------------------------------------------------
Dict{Symbol, Any} with 3 entries:
  :variables => ("rho", "rho_v1", "rho_v2", "rho_e")
  :l2        => [3.8236, 3.93194, 3.93194, 3.91374]
  :linf      => [3.94325, 3.94046, 3.94046, 3.92983]
```

Thus, the order of convergence is in accordance with the expected optimal
order `polydeg + 1 = 4` for polynomials of degree `polydeg = 3` on a uniform
mesh.

Moreover, the entropy conservation property can be verified by running
```julia
julia> include("setup.jl")

julia> trixi_include("elixir_euler_ec.jl")
```
and inspecting the analysis output of `∑∂S/∂U ⋅ Uₜ`, which is zero up to
machine accuracy.

Finally, the plots of the spectrum of the Jacobian of the semidiscretization
can be generated by
```julia
julia> include("setup.jl")

julia> include("elixir_euler_density_wave.jl")
```
This will produce figures in the directory `../figures`.
